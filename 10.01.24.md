# annalyze

## Task - 2

```sql
SELECT * FROM person
SELECT name, age FROM person
WHERE address = 'Moscow';
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/cb0304df-e6bf-4221-93fe-661e5c4a1b00)

## Task - 3

```sql
SELECT name, age FROM person
WHERE address = 'Kazan' and gender = 'female'
ORDER BY name;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/c2f798d2-11e2-4d5d-ae53-43fe89585a1d)

## Task - 4

```sql
SELECT name, rating FROM pizzeria
WHERE rating >= 3.5 AND rating <= 5
ORDER BY rating;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/26831388-0a71-45b5-aa90-9979dd955b0f)

```sql
SELECT name, rating FROM pizzeria
WHERE rating BETWEEN 3.5 AND 5 
ORDER BY rating;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/86773ee1-9e9a-4833-8419-154bfcce1001)

## Task - 5

```sql
SELECT DISTINCT person_id FROM person_visits
WHERE visit_date BETWEEN '2022/01/01' AND '2022/01/07' OR pizzeria_id = 2
ORDER BY person_id DESC;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/396468a5-f0c8-46e8-8b32-a904f6e49d64)

## Task - 6

```sql
SELECT name
FROM person
WHERE id IN (
	SELECT person_id 
	FROM person_order
	WHERE order_date = '2022-01-01' OR order_date = '2022-01-06' OR order_date = '2022-01-09'
);
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/0842bd6f-a722-428b-9b9e-326c8b10fa42)

## Task - 7

```sql
SELECT 
EXISTS(SELECT name FROM person WHERE name = 'Anna');
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/477f59ab-fca8-4eae-a573-536d76934ad4)

------------------------------------------------

## Task - 1

```sql
SELECT id AS object_id, name AS object_name FROM person
UNION ALL
SELECT id AS object_id, pizza_name AS object_name FROM menu
ORDER BY object_id, object_name;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/79ec73b9-13c2-4635-9996-898c7f8b5c78)

## Task - 2

```sql
SELECT name AS object_name FROM person
UNION ALL
SELECT pizza_name AS object_name FROM menu
ORDER BY object_name;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/c29e1b75-486b-4e9f-8255-60ef80ba4a45)

## Task - 3

```sql
SELECT order_date AS action_date, person_id FROM person_order
UNION ALL
SELECT visit_date AS action_date, person_id FROM person_visits
ORDER BY action_date ASC, person_id DESC;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/b99b54f8-cbaa-4c0a-8dd1-60199449ba2b)

## Task - 4

```sql
SELECT person_id FROM person_order
WHERE order_date = '2022-01-07'
EXCEPT
SELECT person_id FROM person_visits
WHERE visit_date = '2022-01-07'
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/77795f4b-ab03-4459-a999-5b71c4939896)

## Task - 5

```sql
SELECT
	person.id AS "person.id",
	person.name AS "person.name",
	person.age,
	person.gender,
	person.address,
	pizzeria.id AS "pizzeria.id",
	pizzeria.name AS "pizzeria.name",
	pizzeria.rating
FROM person
CROSS JOIN pizzeria
ORDER BY "person.id";
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/fa797286-d5c4-4666-acae-7e7ddfc5fbbb)

## Task - 6

```sql
SELECT action_date, person.name FROM (
	SELECT order_date as action_date, person_id FROM person_order
	INTERSECT
	SELECT visit_date, person_id FROM person_visits
) as tab
JOIN person ON tab.person_id = person.id;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/70b4538e-23d5-4d98-8b13-e8565616c754)

## Task - 7

```sql
SELECT 
	person_order.order_date,
	person.name || ' (age:' || person.age || ')' AS person_information
	FROM person_order
JOIN person ON person.id = person_order.person_id;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/7d52edd0-268f-4e7b-aae4-8c729ff905d2)

## Task - 8

```sql

SELECT 
	person_order.order_date,
	person.name || ' (age:' || person.age || ')' AS person_information
	FROM person_order
NATURAL JOIN person;

```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/a8c1b0d7-eb56-4dc5-8e12-efe8d4142ff8)

## Task - 9

```sql



```

---------------------------------------------------Day 02--------------------------------------------------------------

## Exercise 00

```sql
SELECT name FROM (
	SELECT * FROM pizzeria
	LEFT JOIN person_visits ON pizzeria.id = person_visits.pizzeria_id WHERE person_visits.pizzeria_id IS NULL)
as tab;	
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/b4d02a75-ea05-4185-84d9-9b7bd4c061a0)

## Exercise 01

```sql
SELECT visit_date AS missing_date FROM person_visits
WHERE person_id > 2
ORDER BY missing_date ASC;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/a5560136-5155-4958-8c18-5cc4f7cc8a88)

## Exercise 02

```sql

```

## Exercise 03

```sql
WITH missing_cte AS 
	(SELECT visit_date AS missing_date FROM person_visits
		WHERE person_id > 2
		ORDER BY missing_date ASC)
SELECT * FROM missing_cte;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/c4f5bf55-4b11-435e-8263-3cf459b990b2)

## Exercise 04

```sql
SELECT menu.pizza_name, pz.name as pizzeria_name, menu.price p FROM menu
JOIN pizzeria pz ON menu.pizzeria_id = pz.id
WHERE pizza_name = 'mushroom pizza'
or pizza_name = 'pepperoni pizza'
ORDER BY menu.pizza_name, pizzeria_name;
```

![image](https://github.com/rusinadaria/annalyze/assets/112808317/90812b88-25e5-4eb1-ae63-2fa2e15e26b1)


## Exercise 05

```sql
SELECT name FROM person
WHERE gender='female' AND age > 25
ORDER BY name ASC;
```
![image](https://github.com/rusinadaria/annalyze/assets/112808317/3a0b4c2b-65c2-43bc-ac41-6a91ac660862)

## Exercise 06

```sql
SELECT m.pizza_name, pz.name as pizzeria_name FROM person_order po
JOIN person p ON po.person_id = p.id
JOIN menu m ON po.menu_id = m.id
JOIN pizzeria pz ON m.pizzeria_id = pz.id
WHERE p.name = 'Anna' or p.name = 'Denis'
ORDER BY m.pizza_name, pz.name;
```

![image](https://github.com/rusinadaria/annalyze/assets/112808317/db5597d5-609d-44ed-b707-d3f0797f982a)


## Exercise 07

```sql
SELECT pz.name FROM person_visits pv
JOIN person p ON pv.person_id = p.id
JOIN pizzeria pz ON pv.pizzeria_id = pz.id
WHERE pv.visit_date = '2022-01-08' and p.name = 'Dmitriy';
```

![image](https://github.com/rusinadaria/annalyze/assets/112808317/cdf31067-370f-45df-9ac5-07a7caa0e9c3)















